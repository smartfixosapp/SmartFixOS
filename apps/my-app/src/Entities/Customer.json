{
  "name": "Customer",
  "type": "object",
  "description": "Clientes del sistema con validación de contacto obligatorio y soporte B2B",
  "properties": {
    "name": {
      "type": "string",
      "minLength": 2,
      "description": "Nombre completo del cliente"
    },
    "phone": {
      "type": "string",
      "pattern": "^[0-9+()\\-\\s]{6,}$",
      "description": "Teléfono principal del cliente"
    },
    "additional_phones": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[0-9+()\\-\\s]{6,}$"
      },
      "description": "Teléfonos adicionales"
    },
    "email": {
      "type": "string",
      "format": "email",
      "description": "Email del cliente"
    },
    "notes": {
      "type": "string",
      "description": "Notas adicionales"
    },
    "total_orders": {
      "type": "number",
      "default": 0,
      "minimum": 0,
      "description": "Total de órdenes del cliente"
    },
    "loyalty_points": {
      "type": "number",
      "default": 0,
      "minimum": 0,
      "description": "Puntos de fidelización"
    },
    "loyalty_tier": {
      "type": "string",
      "enum": [
        "bronze",
        "silver",
        "gold",
        "platinum"
      ],
      "default": "bronze",
      "description": "Nivel de fidelización"
    },
    "total_spent": {
      "type": "number",
      "default": 0,
      "minimum": 0,
      "description": "Total gastado históricamente"
    },
    "next_appointment": {
      "type": "object",
      "description": "Próxima cita programada",
      "properties": {
        "date": {
          "type": "string",
          "format": "date-time"
        },
        "service_type": {
          "type": "string"
        },
        "recurring": {
          "type": "boolean",
          "default": false
        },
        "frequency": {
          "type": "string",
          "enum": [
            "weekly",
            "biweekly",
            "monthly",
            "quarterly"
          ]
        }
      }
    },
    "is_b2b": {
      "type": "boolean",
      "default": false,
      "description": "Cliente empresarial (B2B)"
    },
    "company_name": {
      "type": "string",
      "description": "Nombre de la empresa (solo B2B)"
    },
    "company_tax_id": {
      "type": "string",
      "description": "RUT/Tax ID de la empresa (OPCIONAL)"
    },
    "billing_contact_person": {
      "type": "string",
      "description": "Persona de contacto para facturación (B2B)"
    },
    "billing_address": {
      "type": "string",
      "description": "Dirección de facturación (B2B)"
    },
    "payment_terms": {
      "type": "string",
      "enum": [
        "NET-15",
        "NET-30",
        "NET-45",
        "NET-60",
        "Prepaid"
      ],
      "default": "NET-30",
      "description": "Términos de pago (B2B)"
    },
    "credit_limit": {
      "type": "number",
      "minimum": 0,
      "description": "Límite de crédito (B2B)"
    },
    "b2b_contacts": {
      "type": "array",
      "description": "Múltiples contactos de la empresa B2B",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre del contacto"
          },
          "role": {
            "type": "string",
            "description": "Cargo o rol (CEO, CFO, IT Manager, etc.)"
          },
          "phone": {
            "type": "string",
            "description": "Teléfono del contacto"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email del contacto"
          },
          "is_primary": {
            "type": "boolean",
            "default": false,
            "description": "Si es contacto principal"
          },
          "notifications_enabled": {
            "type": "boolean",
            "default": true,
            "description": "Recibe notificaciones"
          }
        }
      }
    },
    "portal_access_token": {
      "type": "string",
      "description": "Token único para acceso al portal B2B"
    },
    "portal_access_enabled": {
      "type": "boolean",
      "default": false,
      "description": "Si tiene acceso habilitado al portal"
    }
  },
  "required": [
    "name"
  ],
  "anyOf": [
    {
      "required": [
        "phone"
      ]
    },
    {
      "required": [
        "email"
      ]
    }
  ]
}
